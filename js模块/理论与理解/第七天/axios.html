<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script src="./node_modules/axios/dist/axios.js"></script>
  <script>
    // axios就是一款基于promise封装的ajax库
    // axios是一个函数，但是在他自己身上存储着好多方法和属性供咱们去使用


    (function(){
      class Axios{
        constructor(url,options){
          // this-->当前的Axios的实例
          return new Promise((resolve,reject)=>{
            // 发送ajax请求，当请求成功以后把当前的promise的实例改为成功态，请求失败以后把当前promise的实例改为失败态
          })
        }

        // 在当前大范围里边可以进行构造函数的执行，也可以给当前的类增加共有属性，也可以把当前的类当做对象增加键值对
      }
      function axios(){}

      // 在axios身上会有一个默认的对象，里边存储着一些默认的配置
      axios.defaults = {
        baseURL:'',
        cache:true,
        data:null,
        params:null,
        headers:{
          'Content-type':'application/x-www-form-urlencoded'
        },
        timeout:null,
        transformRequest:function(data){
          if(!data) return null;
          let str = ``;
          for(let key in data){
            if(!data.hasOwnProperty(key)) break;
            str+=`${key}=${data[key]}&`
          }
          str = str.slice(0,str.length-1);
          return str;
        },
        transformResponse:function(data){
          // 人家原来的axios的data是响应主体
          // 咱们现在的data是整个大的返回对象
          return data;
        }
      }
      // 1.get系列的请求方法
      function mergeOption(options){
        let {defaluts} = axios;
         let headers = {...defaults.headers,...options.headers};
         return {...defaults,...options,headers}
      }
      axios.get = function(url,options){
        // 合并当前的options和defaults
        let res = mergeOption(options);
        // 到目前为止咱们的参数合并就算处理完成了
        // 发送请求了
        return new Axios(url,res); // Axios的实例  Promise的实例
      }

      // 2.post系列的请求方法

      axios.all = function(promiseAry = []){
        return Promise.all(promiseAry)
      }
    }());


    // axios.all([axios.get(),p2]).then(()=>{

    // })
   let res =axios.get(url,{params:{},timeout:100}); // 返回结果是一个promise的实例
   res.then(()=>{},()=>{

   })





      // console.dir(axios)
      // axios.get('data.json',{params:{}}).then((res)=>{
      //   console.log(res.data);
      // }).catch((res)=>{
      //   console.log(res);
      // })
  </script>
</body>
</html>
